{% extends "layout.html" %}

{% block content %}

<!-- Progress Indicator -->
<div style="position: absolute; top: 20px; right: 30px; font-weight: bold; font-size: 1.1rem; background: #f0f0f0; padding: 6px 12px; border-radius: 6px;">
  {{ step }} / 7
</div>

<h2 class="text-center mt-4">
  {% if step in [6, 7] %}
    Question {{ step }}: Is this picture AI generated?
  {% else %}
    Question {{ step }}: Please choose the AI image.
  {% endif %}
</h2>

<form method="POST" id="quiz-form">
  <div class="d-flex justify-content-around mt-5">
    {% if step in [6, 7] %}
      <!-- For steps 6 and 7, only one image -->
      <img src="{{ big_quiz_data[step]['image1'] }}"
           alt="Question {{ step }} image"
           style="border: 2px solid #444; width: 50%; height: 300px; object-fit: cover;">
    {% else %}
      <!-- For steps 1 to 5, show two images -->
      <label id="label-image1"
             class="image-choice"
             style="border: 2px solid #444; width: 45%; height: 300px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
        <input type="radio" name="answer" value="image1" required style="display: none;">
        <img src="{{ big_quiz_data[step]['image1'] }}" alt="Image 1" style="width: 100%; height: 100%; object-fit: cover;">
      </label>

      <label id="label-image2"
             class="image-choice"
             style="border: 2px solid #444; width: 45%; height: 300px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
        <input type="radio" name="answer" value="image2" required style="display: none;">
        <img src="{{ big_quiz_data[step]['image2'] }}" alt="Image 2" style="width: 100%; height: 100%; object-fit: cover;">
      </label>
    {% endif %}
  </div>

  {% if step in [6, 7] %}
    <!-- Yes/No options for steps 6 and 7 -->
    <div class="text-center mt-4">
      <label class="mr-3">
        <input type="radio" name="answer" value="yes" required> Yes
      </label>
      <label>
        <input type="radio" name="answer" value="no" required> No
      </label>
    </div>
  {% endif %}

  <div class="d-flex justify-content-between mt-4">
    {% if step > 1 %}
      <a class="btn btn-secondary" href="{{ url_for('big_quiz', step=step - 1) }}">Back</a>
    {% else %}
      <span></span>
    {% endif %}

    {% if step < 7 %}
      <button type="submit" class="btn btn-primary">Next</button>
    {% elif step == 7 %}
      <button type="submit" class="btn btn-success">Submit</button>
    {% endif %}
  </div>
</form>

{% if session.get('quiz_submitted') %}
    <div class="text-center mt-5">
      <h3>{{ session['quiz_complete_message'] }}</h3>
      <p>{{ session['quiz_score_message'] }}</p>
      <a href="/" class="btn btn-primary">Go Home</a>
    </div>
{% endif %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const correct_answers = {
      1: "image1",
      2: "image2",
      3: "image1",
      4: "image1",
      5: "image1",
      6: "yes",
      7: "yes"
    };

    function clearBorders() {
      const label1 = document.getElementById("label-image1");
      const label2 = document.getElementById("label-image2");
      if (label1) label1.classList.remove("correct", "incorrect");
      if (label2) label2.classList.remove("correct", "incorrect");
    }

    document.querySelectorAll('input[name="answer"]').forEach(input => {
      input.addEventListener('change', function () {
        const selected = this.value;
        const step = {{ step }};
        const correct = correct_answers[step];

        clearBorders();

        const selectedLabel = document.getElementById("label-" + selected);
        const correctLabel = document.getElementById("label-" + correct);

        if (selectedLabel) selectedLabel.classList.add(selected === correct ? "correct" : "incorrect");
        if (correctLabel && selected !== correct) correctLabel.classList.add("correct");
      });
    });
  });
</script>

{% endblock %}






